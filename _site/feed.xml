<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom"><generator uri="http://jekyllrb.com" version="3.1.3">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2016-05-31T22:22:21+08:00</updated><id>/</id><title>Yifan Jiang</title><subtitle>My personal homepage.</subtitle><author><name>Yifan Jiang</name></author><entry><title>UAV Communication Relay for another UAV</title><link href="/post/UAV-Communication-Relay-for-another-UAV/" rel="alternate" type="text/html" title="UAV Communication Relay for another UAV" /><published>2016-05-30T00:00:00+08:00</published><updated>2016-05-30T00:00:00+08:00</updated><id>/post/UAV-Communication-Relay-for-another-UAV</id><content type="html" xml:base="/post/UAV-Communication-Relay-for-another-UAV/">&lt;p&gt;This project is my undergraduate final year project, and I wrote my undergraduate thesis out of it. Hopefully this short article will give you a brief idea about what I’ve done. This project was a teamwork, I could not complete it without my team mates Cai Lingfeng and Wan Hiu Fung. I would also like to thank our supervisor Prof Wen Chih Yung, an absolutely nice and helpful prof.&lt;/p&gt;

&lt;p&gt;This project has helped us win &lt;strong&gt;champion&lt;/strong&gt; at the &lt;a href=&quot;http://www.iaa.ncku.edu.tw/~whlai/uav/2016/index.html&quot;&gt;2016 Taiwan Unmanned Aircraft Design Competition&lt;/a&gt; (website in Chinese), in which we take great pride. we are also looking to publish a paper based on it.&lt;/p&gt;

&lt;h2 id=&quot;the-idea&quot;&gt;The Idea&lt;/h2&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;Why do we need radio communication ?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;If your UAV goes out for a mission, you want to make sure that you can contact the UAV at any time, to send commands to it, and to know what it is doing. There are two reasons for this. The first one is also the most obvious: if you cannot even contact your UAV, how can you do the mission with it? The second one is, if you lose contact with your UAV, your UAV may do unexpected actions without you knowing it, such actions can damage properties, and can ever hurt or kill somebody.&lt;/p&gt;

&lt;p&gt;The choice of radio over other technologies such as WiFi or 3G/4G mobile network is made for 2 reasons:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Radio has longer range than WiFi &lt;/li&gt;
  &lt;li&gt;Radio has shorter (and more predictable) delay than 3G/4G &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Although radio generally has lower data rates.&lt;/p&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;Why relaying radio communication ?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;If your UAV does a mission in areas where you cannot directly, does it mean you have to abort the mission? With traditional UAV systems, yes. But with radio communication relay, NO! With the help of radio communication relay, the UAV can fly into areas where direct radio communication with you is blocked.&lt;/p&gt;

&lt;p&gt;This idea is illustrated in Fig.1. If radio communication is blocked by, say, a mountain, then the use of relay can easily help us get arround the obstacle. In addition, relay can also help extend the range of communication, so you can go further with a radio transceiver of smaller power.&lt;/p&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/idea.png&quot;&gt;&lt;img src=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/idea.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Fig.1 UAV Radio Communication Relay&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;system-architecture&quot;&gt;System Architecture&lt;/h2&gt;

&lt;p&gt;To demonstrate radio communication relay, a small UAV was constructed using 2 UAVs and a Ground Control Station, which we call “Mini GCS”. As shown in Fig.2, names are given to the UAVs: Mom is the one that relays communication at the middle, and Son is the one that actually executes the mission. Fig.3 shows the critical subsystems of the demonstration UAV system.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/mom_son.png&quot;&gt;&lt;img src=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/mom_son.png&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/sys_block.png&quot;&gt;&lt;img src=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/sys_block.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Fig.2 (Left) Mom, Son, and Mini GCS&lt;/figcaption&gt;
    &lt;figcaption&gt;Fig.3 (Right) Subsystems&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong&gt; Communication &lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;915MHz Radio telemetry by 3DR (3DR Radio) was used to construct the communication network. A total of 4 3DR Radios were used to establish 2 independent radio data links, one between &lt;span style=&quot;color:#008000&quot;&gt; Mom and GCS&lt;/span&gt;, and the other between &lt;span style=&quot;color:#008000&quot;&gt; Mom and Son&lt;/span&gt; (Fig.4). The 2 radio links are kept interference-free using the Frequency Hopping (FHSS) technique, which is a built-in feature of 3DR Radio. The 2 radio links use different frequency hopping sequence, which are determined by a unique “Net ID” (shown in Fig.5).&lt;/p&gt;

&lt;figure class=&quot;third&quot;&gt;
    &lt;a href=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/radio.png&quot;&gt;&lt;img src=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/radio.png&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/radio_setting.png&quot;&gt;&lt;img src=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/radio_setting.png&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/frame.png&quot;&gt;&lt;img src=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/frame.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Fig.4 (Left) Radio Communication Architecture&lt;/figcaption&gt;
    &lt;figcaption&gt;Fig.5 (Mid) Frequency Hopping Settings&lt;/figcaption&gt;
    &lt;figcaption&gt;Fig.6 (Right) Format of Data Frame&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;In order to detect errors in data transmission, a Cyclic Redundancy Checking (CRC) error checking stage was added. To do this, data is organized into frames, and the frames have fixed format (Fig.6). At then end of each frame, a 4-byte CRC code is attached. When a frame is received by UAV or GCS, the receiver will first record the CRC code received over radio (CRC_remote), and then compute a new CRC code based on the received data (CRC_local). If CRC_remote is equal to CRC_local, then the frame is error-free. Otherwise, the received frame has error(s) in it and has to be discarded. More details about CRC can be found &lt;a href=&quot;https://en.wikipedia.org/wiki/Cyclic_redundancy_check&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong&gt; Mission Control &lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This mission control unit is used to do a number of jobs:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;It handles message routing and communication relay.&lt;/li&gt;
  &lt;li&gt;It interfaces GCS to flight controller. User can send relatively simple commands from GCS, then mission control translates them into the low-level instructions to the flight controller.&lt;/li&gt;
  &lt;li&gt;It is supposed to control the mission with intelligence, sadly we still haven’t implemented that (will we ?).&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The mission control unit is in fact a software system, developed with &lt;a href=&quot;http://www.ros.org/&quot;&gt;ROS&lt;/a&gt;, than runs on a &lt;a href=&quot;https://www.raspberrypi.org/products/raspberry-pi-2-model-b/&quot;&gt;Raspberry Pi 2B&lt;/a&gt;. The mission control unit communicates with radio telemetries and flight controller through UART ports. So it means as long as you are using a UAV with supported flight controller (in our case, the &lt;a href=&quot;https://pixhawk.org/choice&quot;&gt;PixHawk Flight Controller&lt;/a&gt;), then you can plug this mission control unit into it and turn it into an on-air communication relay station! The system is totally platform independent, which is cool and convenient.&lt;/p&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong&gt; Flight Control &amp;amp; Aircraft &lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;There is nothing very special with the actual aircraft used. For testing, we built 2 quad-rotor copters out of off-the-shelf components, and used them as Mom and Son. For flight controller, we selected &lt;a href=&quot;https://pixhawk.org/choice&quot;&gt;PixHawk Flight Controller&lt;/a&gt; because it is powerful and plenty of resources are available online. Fig.8 shows the UAVs during a field flight test.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/mission-control.png&quot;&gt;&lt;img src=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/mission-control.png&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/test.png&quot;&gt;&lt;img src=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/test.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Fig.7 (Left) Mission Control Unit Mounted on UAV&lt;/figcaption&gt;
    &lt;figcaption&gt;Fig.8 (Right) UAV Mom and Son, during a test&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong&gt; Ground Control Station (GCS) &lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;We developed our own version of GCS software, which we call “Mini GCS”. It was writen fully in-house using C#. A screen shoot is given in Fig.9 The Mini GCS has a number of cool features:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;A UAV status window, which allows you to monitor BOTH UAVs at the same time.&lt;/li&gt;
  &lt;li&gt;A map display, that shows the location of both UAVs in real time.&lt;/li&gt;
  &lt;li&gt;A Linux command line style interface, in which you can type commands and send them to the UAV that you specify, Mom or Son.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;A number of useful commands:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;arm              be ready to fly, engage motors
takeoff	         takeoff and fly to specified height
land             land immediately
setmode          change to flight mode of the UAV
rtl              return to home position, and land there
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/mini-gcs.png&quot;&gt;&lt;img src=&quot;/images/2016-05-30-UAV-Communication-Relay-for-another-UAV/mini-gcs.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Fig.9 Mini GCS screen shoot (UAVs not yet displayed on map)&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;testing-and-results&quot;&gt;Testing and results&lt;/h2&gt;</content><author><name>Yifan Jiang</name></author><category term="tech" /><summary>This project is my undergraduate final year project, and I wrote my undergraduate thesis out of it. Hopefully this short article will give you a brief idea about what I’ve done. This project was a teamwork, I could not complete it without my team mates Cai Lingfeng and Wan Hiu Fung. I would also like to thank our supervisor Prof Wen Chih Yung, an absolutely nice and helpful prof.</summary></entry><entry><title>Audio Amplifier based on LM1875</title><link href="/post/LM1875-Audio-Amplifier/" rel="alternate" type="text/html" title="Audio Amplifier based on LM1875" /><published>2016-05-02T00:00:00+08:00</published><updated>2016-05-02T00:00:00+08:00</updated><id>/post/LM1875-Audio-Amplifier</id><content type="html" xml:base="/post/LM1875-Audio-Amplifier/">&lt;p&gt;I am not (yet) a big fan of Hi-Fi audio. However, driven by some interests and some willingness to explore new things, I decided to build my own in-house audio amplifier, using the famous LM1875 audio power amplifier IC. LM1875 is a (supposedly) easy-to-use audio amplifier IC, with numerous reference designs available from the internet. For a first-time try-out, using this IC should guarantee reasonable sound quality without too much debugging efforts. Staying within beginner-friendly region, at least for the first few times, is always smart.&lt;/p&gt;

&lt;h2 id=&quot;design&quot;&gt;Design&lt;/h2&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;The Amplifier Circuit&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;As I mentioned earlier, LM1875 is a pretty easy-to-use audio amplifier IC. According to its manufacturer, Texas Instruments, LM1875 is a high-performance and low-distortion amplifier designed to operate with minimum external components. To work out my own design, I referred to a number of designs made by other audio hobbyists as well as the reference design provided in LM1875’s datasheet. The following sources have been valuable:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt; LM1875 datasheet, available at &lt;a href=&quot;http://www.ti.com/product/LM1875&quot;&gt;here&lt;/a&gt; &lt;/li&gt;
  &lt;li&gt; An audio hobbyist&#39;s design, unknown author, available at &lt;a href=&quot;https://sites.google.com/site/amplificatoare/lm1875-audio-amplifier-20w&quot;&gt;here&lt;/a&gt; &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Fig.1 shows the schematic of the amplifier circuit. The supply voltages, V+ and V-, are +16V and -16V respectively. The closed loop gain of the circuit is about 26.4dB. Resistor R6 and capacitor C9 form a low-pass filter, screening out high-frequency noise from input. Inductors L1 and L2 and resistor R12 form another low-pass filter, taking out high-frequency noise from amplifier output. Audio signal input and feed-back GND is isolated from the real power ground by a 10-ohm resistor, R7. This design further reduces noise.&lt;/p&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;The Power Supply Circuit&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Fig.2 shows the schematic of the power supply circuit. The power supply unit takes in 12VAC, rectifies and filters it, giving out +-16VDC outputs. I may have added more filtering capacitors than actually needed. But it helps reduce output voltage ripples.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/amplifier-circuit.png&quot;&gt;&lt;img src=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/amplifier-circuit.png&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/power-supply-circuit.png&quot;&gt;&lt;img src=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/power-supply-circuit.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Fig.1 (Left) Amplifier circuit schematic&lt;/figcaption&gt;
    &lt;figcaption&gt;Fig.2 (Right) Power supply circuit schematic&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;Others Circuits&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The amplifier also features a number of other circuits:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;A simple in-rush current limiter (ICL) circuit, to slow down the charging process of power supply capacitors on power-up (Fig.3).&lt;/li&gt;
  &lt;li&gt;A manual-controlled speaker protection circuit, protecting the speakers from the start-up transients. The speakers are simply disconnected from amplifier output when the amplifier is powering up. After full power-up, the speakers are re-connected. This is realized using 2 relays, which are in turn controlled manually, using a switch (Fig.4).&lt;/li&gt;
  &lt;li&gt;A potentiometer for volume adjustment. It in fact builds 2 potentiometers on the same axis, allowing volume of both Left and Right channels to be adjusted equally. On the same axis there is also a rotary switch, which I use to control the speaker protection circuit.&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/ICL-circuit.png&quot;&gt;&lt;img src=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/ICL-circuit.png&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/speaker-protection-circuit.png&quot;&gt;&lt;img src=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/speaker-protection-circuit.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Fig.3 (Left) Inrush current limiter (ICL) circuit schematic&lt;/figcaption&gt;
    &lt;figcaption&gt;Fig.4 (Right) Speaker protection circuit schematic&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;The working principle of the ICL circuit is simple. As shown in Fig.3, on power-up, the relay SW4 is in OFF state, and AC current has to flow through the 56-ohm resistor R-ICL, which limits the charging current of the power supply capacitors. When the power supply output voltage rises to a level (around 12V), SW4 is activated (into ON state), short-connecting R-ICL. The power supply then finishes charging, and no current flows through R-ICL in normal amplifier operation. The 2 terminals, V-IN and PE1, are used to sense the power-supply output voltage. With the ICL circuit, the power supply fully starts up in around 8 seconds.&lt;/p&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;The PCBs&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Fig.5 and Fig.6 shows the PCB layouts of the amplifier circuit and power supply circuit. I quickly sketched them using Eagle, and am not sure whether everything is perfect. A few useful guidelines in the amplifier circuit PCB layout:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt; Separate small-signal (audio input) and large-signal (amplifier power supply and output) GND. The 2 joins together only at a single point. &lt;/li&gt;
  &lt;li&gt; Use star-grounding whenever possible. &lt;/li&gt;
  &lt;li&gt; Try not to let signal and power paths cross one another in different layers, to minimise cross-coupling of noise (in fact I tried to layout all the traces in the same layer). &lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/amp-pcb.png&quot;&gt;&lt;img src=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/amp-pcb.png&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/power-supply-pcb.png&quot;&gt;&lt;img src=&quot;/images/2016-05-02-LM1875-Audio-Amplifier/power-supply-pcb.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Fig.5 (Left) Amplifier circuit PCB&lt;/figcaption&gt;
    &lt;figcaption&gt;Fig.6 (Right) Power supply circuit PCB&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;to be continued.&lt;/p&gt;</content><author><name>Yifan Jiang</name></author><category term="tech" /><category term="DIY" /><summary>I am not (yet) a big fan of Hi-Fi audio. However, driven by some interests and some willingness to explore new things, I decided to build my own in-house audio amplifier, using the famous LM1875 audio power amplifier IC. LM1875 is a (supposedly) easy-to-use audio amplifier IC, with numerous reference designs available from the internet. For a first-time try-out, using this IC should guarantee reasonable sound quality without too much debugging efforts. Staying within beginner-friendly region, at least for the first few times, is always smart.</summary></entry><entry><title>First Post</title><link href="/post/try/" rel="alternate" type="text/html" title="First Post" /><published>2016-04-25T00:00:00+08:00</published><updated>2016-04-25T00:00:00+08:00</updated><id>/post/try</id><content type="html" xml:base="/post/try/">&lt;p&gt;Hey guys. I am trying to construct a personal homepage, and this is my very first post. GitHub provids a really convenient place to host my homepage, and Jekyll is making the development easy.&lt;/p&gt;

&lt;p&gt;Building a homepage requires consistent efforts. I will try to add interesting things to it bit by bit, and hopefully one day this homepage will become lively and interesting.&lt;/p&gt;</content><author><name>Yifan Jiang</name></author><category term="life" /><summary>Hey guys. I am trying to construct a personal homepage, and this is my very first post. GitHub provids a really convenient place to host my homepage, and Jekyll is making the development easy.</summary></entry></feed>
